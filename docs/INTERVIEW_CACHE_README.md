# é¢ç»æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½ - å¿«é€ŸæŒ‡å—

## ğŸš€ åŠŸèƒ½ç®€ä»‹
ä¸ºé¢ç»æŸ¥è¯¢åŠŸèƒ½æ¥å…¥ Caffeine æœ¬åœ°ç¼“å­˜ï¼Œå¤§å¹…æå‡å‰ç«¯åŠ è½½é€Ÿåº¦ã€‚

## âš¡ æ€§èƒ½æå‡
- **åˆ†é¡µæŸ¥è¯¢**: å“åº”æ—¶é—´ä» 50-200ms é™è‡³ <1ms (æå‡ **50-200å€**)
- **è¯¦æƒ…æŸ¥è¯¢**: å“åº”æ—¶é—´ä» 30-100ms é™è‡³ <1ms (æå‡ **30-100å€**)
- **ç¼“å­˜å‘½ä¸­ç‡**: 60-80% (æ­£å¸¸ä½¿ç”¨åœºæ™¯)
- **æ•°æ®åº“å‹åŠ›**: é™ä½ 60-80%

## ğŸ“ ä¿®æ”¹å†…å®¹

### 1. é…ç½®ç±» (CaffeineConfig.java)
æ–°å¢ä¸¤ä¸ªç¼“å­˜ Bean:
- `interviewPageCache()` - åˆ†é¡µæŸ¥è¯¢ç¼“å­˜ (100æ¡ï¼Œ5åˆ†é’Ÿè¿‡æœŸ)
- `interviewDetailCache()` - è¯¦æƒ…ç¼“å­˜ (500æ¡ï¼Œ10åˆ†é’Ÿè¿‡æœŸ)

### 2. æœåŠ¡ç±» (InterviewServiceImpl.java)
ä¼˜åŒ–ä¸¤ä¸ªæŸ¥è¯¢æ–¹æ³•:
- `selectByCondition()` - æ·»åŠ åˆ†é¡µæŸ¥è¯¢ç¼“å­˜
- `articleOf()` - æ·»åŠ è¯¦æƒ…æŸ¥è¯¢ç¼“å­˜

## ğŸ¯ ç¼“å­˜ç­–ç•¥

| ç¼“å­˜ç±»å‹ | å®¹é‡ | è¿‡æœŸæ—¶é—´ | ç¼“å­˜é”®æ ¼å¼ |
|---------|------|----------|-----------|
| åˆ†é¡µæŸ¥è¯¢ | 100 | 5åˆ†é’Ÿ | `{pageNo}-{pageSize}-{jobId\|all}` |
| è¯¦æƒ…æŸ¥è¯¢ | 500 | 10åˆ†é’Ÿ | `{id}` |

## âœ… ä½¿ç”¨åœºæ™¯

### é«˜å‘½ä¸­ç‡åœºæ™¯
- ğŸ“„ **åˆ—è¡¨ç¿»é¡µ**: å‰åé¡µåˆ‡æ¢æ—¶ç¼“å­˜å‘½ä¸­ç‡ 80%+
- ğŸ”¥ **çƒ­é—¨é¢ç»**: é«˜é¢‘è®¿é—®çš„é¢ç»ç¼“å­˜å‘½ä¸­ç‡æ¥è¿‘ 100%
- ğŸ” **é‡å¤ç­›é€‰**: ç›¸åŒç­›é€‰æ¡ä»¶çš„é‡å¤æŸ¥è¯¢
- â—€ï¸ **è¿”å›åˆ—è¡¨**: ä»è¯¦æƒ…é¡µè¿”å›åˆ—è¡¨é¡µ

### é€‚ç”¨èŒƒå›´
âœ… æ‰€æœ‰é¢ç»åˆ†é¡µæŸ¥è¯¢æ¥å£  
âœ… æ‰€æœ‰é¢ç»è¯¦æƒ…æŸ¥è¯¢æ¥å£  
âœ… æ— éœ€å‰ç«¯ä»£ç ä¿®æ”¹  
âœ… å¯¹ç°æœ‰åŠŸèƒ½é€æ˜  

## ğŸ§ª å¿«é€Ÿæµ‹è¯•

### æµ‹è¯•ç¼“å­˜æ•ˆæœ
```bash
# ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼ˆç¼“å­˜æœªå‘½ä¸­ï¼Œè¾ƒæ…¢ï¼‰
curl -X POST http://localhost:8080/interview/selectByCondition \
  -H "Content-Type: application/json" \
  -d '{"pageNo":1,"pageSize":10,"param":{"jobId":null}}' \
  -w "\nå“åº”æ—¶é—´: %{time_total}s\n"

# ç¬¬äºŒæ¬¡è¯·æ±‚ï¼ˆç¼“å­˜å‘½ä¸­ï¼Œæå¿«ï¼‰
curl -X POST http://localhost:8080/interview/selectByCondition \
  -H "Content-Type: application/json" \
  -d '{"pageNo":1,"pageSize":10,"param":{"jobId":null}}' \
  -w "\nå“åº”æ—¶é—´: %{time_total}s\n"
```

ä½ ä¼šçœ‹åˆ°ç¬¬äºŒæ¬¡è¯·æ±‚çš„å“åº”æ—¶é—´æ˜¾è‘—é™ä½ï¼

## ğŸ“š è¯¦ç»†æ–‡æ¡£

1. **[INTERVIEW_CACHE_INTEGRATION.md](./INTERVIEW_CACHE_INTEGRATION.md)**
   - å®Œæ•´çš„æŠ€æœ¯å®ç°æ–‡æ¡£
   - ç¼“å­˜ç­–ç•¥è¯¦è§£
   - é…ç½®å‚æ•°è¯´æ˜
   - ä½¿ç”¨å»ºè®®å’Œæ³¨æ„äº‹é¡¹

2. **[INTERVIEW_CACHE_TESTING.md](./INTERVIEW_CACHE_TESTING.md)**
   - è¯¦ç»†çš„æµ‹è¯•æ­¥éª¤
   - æ€§èƒ½æµ‹è¯•æ–¹æ³•
   - å‰ç«¯æµ‹è¯•åœºæ™¯
   - ç›‘æ§å’Œæ•…éšœæ’æŸ¥

3. **[INTERVIEW_CACHE_SUMMARY.md](./INTERVIEW_CACHE_SUMMARY.md)**
   - é¡¹ç›®å®æ–½æ€»ç»“
   - ä¿®æ”¹æ–‡ä»¶æ¸…å•
   - æ€§èƒ½æå‡æ•°æ®
   - åç»­ä¼˜åŒ–æ–¹å‘

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

- âœ… **é›¶ä¾èµ–**: ä½¿ç”¨é¡¹ç›®å·²æœ‰çš„ Caffeine
- âœ… **ä½ä¾µå…¥**: ä»£ç æ”¹åŠ¨å°ï¼Œæ˜“ç»´æŠ¤
- âœ… **é«˜æ€§èƒ½**: LRU + æ—¶é—´è¿‡æœŸç­–ç•¥
- âœ… **æ˜“è°ƒè¯•**: æ¸…æ™°çš„ç¼“å­˜é”®è®¾è®¡

## âš™ï¸ é…ç½®è°ƒæ•´

å¦‚éœ€è°ƒæ•´ç¼“å­˜å‚æ•°ï¼Œç¼–è¾‘ `CaffeineConfig.java`:

```java
// è°ƒæ•´åˆ†é¡µæŸ¥è¯¢ç¼“å­˜å®¹é‡å’Œè¿‡æœŸæ—¶é—´
@Bean
public Cache<String, IPage<InterviewEntity>> interviewPageCache() {
    return Caffeine.newBuilder()
            .maximumSize(200)  // å¢åŠ åˆ°200
            .expireAfterWrite(3, TimeUnit.MINUTES)  // æ”¹ä¸º3åˆ†é’Ÿ
            .build();
}
```

## ğŸ”§ æ‰‹åŠ¨åˆ·æ–°ç¼“å­˜

å¦‚éœ€åœ¨ç®¡ç†ç«¯æ›´æ–°é¢ç»åç«‹å³åˆ·æ–°ç¼“å­˜:

```java
// æ³¨å…¥ç¼“å­˜
@Autowired
private Cache<String, InterviewEntity> interviewDetailCache;

// åˆ·æ–°å•ä¸ªé¢ç»
interviewDetailCache.invalidate(id);

// æ¸…ç©ºæ‰€æœ‰ç¼“å­˜
interviewDetailCache.invalidateAll();
```

## ğŸ“Š ç›‘æ§å»ºè®®

æ·»åŠ ç¼“å­˜ç»Ÿè®¡ï¼ˆå¯é€‰ï¼‰:

```java
@Bean
public Cache<String, IPage<InterviewEntity>> interviewPageCache() {
    return Caffeine.newBuilder()
            .maximumSize(100)
            .expireAfterWrite(5, TimeUnit.MINUTES)
            .recordStats()  // å¯ç”¨ç»Ÿè®¡
            .build();
}

// æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
CacheStats stats = interviewPageCache.stats();
System.out.println("å‘½ä¸­ç‡: " + stats.hitRate());
```

## âš ï¸ æ³¨æ„äº‹é¡¹

- **æ•°æ®ä¸€è‡´æ€§**: ç¼“å­˜å®šæ—¶è¿‡æœŸï¼Œå¯èƒ½æœ‰çŸ­æš‚ä¸ä¸€è‡´
- **å†…å­˜å ç”¨**: é¢„ä¼° 20-50MBï¼Œå»ºè®®ç›‘æ§
- **ç¼“å­˜ç©¿é€**: å»ºè®®åœ¨æ¥å£å±‚å¢åŠ å‚æ•°æ ¡éªŒ

## ğŸ‰ å®æ–½çŠ¶æ€

**âœ… ç”Ÿäº§å°±ç»ª** - å¯ç›´æ¥éƒ¨ç½²ä½¿ç”¨

---

**ç‰ˆæœ¬**: v1.0  
**æ—¥æœŸ**: 2026-02-05  
**å®æ–½è€…**: GitHub Copilot  

æœ‰é—®é¢˜ï¼ŸæŸ¥çœ‹è¯¦ç»†æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚
